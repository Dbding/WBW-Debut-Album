<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>王不亡 - 個人音樂網頁 (動態封面版)</title>
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- 引入 Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #000;
            color: #fff;
            overflow: hidden; /* 防止整個頁面滾動 */
        }
        #starlight-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            cursor: grab;
        }
        #starlight-canvas:active {
            cursor: grabbing;
        }
        .content-card {
            background-color: rgba(17, 24, 39, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }
        .track-item:not(:last-child) {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        /* SVG 動態封面: 皇冠 */
        .svg-cover-crown .crown-light {
            animation: pulse 4s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 0.5; transform: scale(0.95); }
            50% { opacity: 1; transform: scale(1.05); }
        }
        /* 自訂滾動條樣式 */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="antialiased">

    <!-- 回到官網按鈕 (改為 button 並加上 id) -->
    <button id="back-to-home-button"
       class="fixed top-4 right-4 z-50 bg-black/50 backdrop-blur-sm border border-gray-600 text-gray-300 px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-gray-700/70 hover:text-white transition-colors shadow-lg">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z" />
        </svg>
        <span class="hidden sm:inline">返回主頁</span>
    </button>

    <!-- 3D 動畫背景 -->
    <div id="starlight-canvas"></div>

    <!-- 主要內容 (加上 pointer-events-none 讓事件穿透) -->
    <main class="h-screen w-screen flex items-center justify-center p-4 sm:p-6 lg:p-8 pointer-events-none">
        
        <!-- 卡片本身恢復 pointer-events-auto 讓其可以被互動 -->
        <div class="content-card rounded-xl shadow-2xl w-full max-w-3xl h-auto max-h-[85vh] flex flex-col pointer-events-auto">
            
            <!-- 頂部專輯資訊 -->
            <div class="p-6 sm:p-8 flex flex-col md:flex-row items-center gap-6 md:gap-8 border-b border-gray-700 flex-shrink-0">
                <div class="w-40 h-40 md:w-48 md:h-48 flex-shrink-0">
                    <svg class="svg-cover-crown w-full h-full" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <defs>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3.5" result="coloredBlur"></feGaussianBlur>
                                <feMerge>
                                    <feMergeNode in="coloredBlur"></feMergeNode>
                                    <feMergeNode in="SourceGraphic"></feMergeNode>
                                </feMerge>
                            </filter>
                        </defs>
                        <g filter="url(#glow)" class="crown-light">
                             <path d="M 20 80 L 25 40 L 40 55 L 50 30 L 60 55 L 75 40 L 80 80 Z" fill="none" stroke="#E9D5A1" stroke-width="4" stroke-linejoin="round" stroke-linecap="round"/>
                        </g>
                    </svg>
                </div>
                <div class="text-center md:text-left">
                     <h1 class="text-5xl sm:text-6xl font-bold text-white flex items-center justify-center md:justify-start gap-x-2">
                        王不亡
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a.75.75 0 00-1.06-1.06L9 10.94l-1.72-1.72a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.06 0l3.75-3.75z" clip-rule="evenodd" />
                        </svg>
                    </h1>
                    <p class="text-xl sm:text-2xl text-gray-300 mt-2">Wang Bu-Wang</p>
                    <p class="text-gray-400 mt-4 text-lg">一張探索存在、記憶與虛無的音樂專輯。透過聲音的紋理，我們試圖在縫隙中尋找家園，在廢鐵中看見夢想。</p>
                </div>
            </div>
            
            <!-- 曲目列表標題 (移出滾動區)-->
            <h2 class="text-3xl font-bold text-white px-6 sm:px-8 pt-6 pb-2 flex-shrink-0">曲目列表</h2>

            <!-- 可滾動的曲目列表 -->
            <div class="px-6 sm:px-8 pb-6 overflow-y-auto custom-scrollbar flex-grow">
                <div id="track-list" class="space-y-4">
                    <!-- 曲目將由 JS 動態生成 -->
                </div>
            </div>
        </div>

    </main>
    
    <footer class="fixed bottom-4 w-full text-center text-gray-600 text-xs">
        <p>© 2025 Wang Bu-Wang. All Rights Reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // 曲目數據
            const tracks = [
                { title: "王不亡，亡的是你們", url: "https://open.spotify.com/embed/track/6QqvzkZSwqUW23akhozgg6" },
                { title: "地板知道", url: "https://open.spotify.com/embed/track/7dVAbcs7Ny68KIClokYorj" },
                { title: "縫隙家園", url: "https://open.spotify.com/embed/track/2Q3U5eEMSHH9REaxG601dk" },
                { title: "廢鐵猿之夢", url: "https://open.spotify.com/embed/track/76enWYcfd8knUKkDFi42ze" },
                { title: "雪偏舟", url: "https://open.spotify.com/embed/track/10hfnAE4WpkXfpIX4GVy2B" },
                { title: "蝦花曾開過", url: "https://open.spotify.com/embed/track/1gzwif6jTetRcm5CuxxIPY" },
                { title: "我像嗎", url: "https://open.spotify.com/embed/track/2g5Y3yIRRiSootIf9c9rKA" },
                { title: "Let Light In", url: "https://open.spotify.com/embed/track/4Ci4VGTxwRkHDnnPiyOShz" },
                { title: "照完還是空", url: "https://open.spotify.com/embed/track/5EsBs0AdGIhWFQTCswJ1pJ" },
                { title: "王令開始", url: "https://open.spotify.com/embed/track/4mRstoVpZnLJkweHPJRkbx" },
            ];

            const trackListContainer = document.getElementById('track-list');

            // 動態生成曲目列表
            tracks.forEach((track, index) => {
                const trackElement = document.createElement('div');
                trackElement.className = 'track-item pt-4 pb-2';
                trackElement.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <p class="text-lg font-medium text-gray-200">${index + 1}. ${track.title}</p>
                    </div>
                    <iframe style="border-radius:12px" src="${track.url}?utm_source=generator&theme=0" width="100%" height="80" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
                `;
                trackListContainer.appendChild(trackElement);
            });

            // --- 恢復可拖動的 Three.js 星空動畫 ---
            const container = document.getElementById('starlight-canvas');
            if (container) {
                let scene, camera, renderer, particles, mouseX = 0, mouseY = 0;
                let isMouseDown = false;
                let shootingStars, shootingStarVelocities;
                
                function init() {
                    const width = window.innerWidth;
                    const height = window.innerHeight;
                    
                    scene = new THREE.Scene();
                    scene.fog = new THREE.FogExp2(0x000000, 0.001);
                    camera = new THREE.PerspectiveCamera(75, width / height, 1, 4000);
                    camera.position.z = 1000;
                    renderer = new THREE.WebGLRenderer({ antialias: true });
                    renderer.setPixelRatio(window.devicePixelRatio);
                    renderer.setSize(width, height);
                    container.appendChild(renderer.domElement);
                    
                    // 背景星空
                    const geometry = new THREE.BufferGeometry();
                    const vertices = [];
                    const colors = [];
                    const colorPalette = [
                        new THREE.Color(0xdddddd), // 淺灰
                        new THREE.Color(0xddeeff), // 淡藍
                        new THREE.Color(0xffeedd)  // 淡黃
                    ];
                    for (let i = 0; i < 20000; i++) {
                        vertices.push(
                            Math.random() * 3000 - 1500,
                            Math.random() * 3000 - 1500,
                            Math.random() * 3000 - 1500
                        );
                        const color = colorPalette[Math.floor(Math.random() * colorPalette.length)];
                        colors.push(color.r, color.g, color.b);
                    }
                    geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
                    geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
                    
                    const material = new THREE.PointsMaterial({ size: 2, transparent: true, opacity: 0.8, vertexColors: true });
                    particles = new THREE.Points(geometry, material);
                    scene.add(particles);

                    // 流星
                    const shootingStarGeometry = new THREE.BufferGeometry();
                    const shootingStarVertices = [];
                    shootingStarVelocities = [];
                    for (let i = 0; i < 30; i++) {
                        shootingStarVertices.push(
                            Math.random() * 3000 - 1500,
                            Math.random() * 3000 - 1500,
                            Math.random() * 4000 - 2000
                        );
                        shootingStarVelocities.push({
                            x: (Math.random() - 0.5) * 15 + 15,
                            y: (Math.random() - 0.5) * 15 - 15,
                        });
                    }
                    shootingStarGeometry.setAttribute('position', new THREE.Float32BufferAttribute(shootingStarVertices, 3));
                    const shootingStarMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 5, transparent: true, opacity: 1 });
                    shootingStars = new THREE.Points(shootingStarGeometry, shootingStarMaterial);
                    scene.add(shootingStars);

                    container.addEventListener('pointerdown', onPointerDown);
                    container.addEventListener('pointerup', onPointerUp);
                    container.addEventListener('pointermove', onPointerMove);
                    window.addEventListener('resize', onWindowResize);
                }

                function onWindowResize() {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                }

                function onPointerDown(event) {
                    isMouseDown = true;
                }

                function onPointerUp() {
                    isMouseDown = false;
                }

                function onPointerMove(event) {
                    // We only want to update the mouse position when the mouse is down
                    if (isMouseDown) {
                         mouseX = event.clientX - (window.innerWidth / 2);
                         mouseY = event.clientY - (window.innerHeight / 2);
                    }
                }

                function animate() {
                    requestAnimationFrame(animate);
                    render();
                }

                function render() {
                    camera.position.x += (mouseX - camera.position.x) * 0.05;
                    camera.position.y += (-mouseY - camera.position.y) * 0.05;
                    camera.lookAt(scene.position);
                    particles.rotation.y += 0.0002;

                    // 持續更新流星位置
                    const ssPositions = shootingStars.geometry.attributes.position.array;
                    for (let i = 0; i < ssPositions.length; i += 3) {
                        const vIndex = i / 3;
                        ssPositions[i] -= shootingStarVelocities[vIndex].x;
                        ssPositions[i+1] -= shootingStarVelocities[vIndex].y;
                        
                        if (ssPositions[i] < -2000 || ssPositions[i+1] < -2000) {
                            if (Math.random() > 0.5) {
                                ssPositions[i] = Math.random() * 1000 + 1000;
                                ssPositions[i+1] = Math.random() * 3000 - 1500;
                            } else {
                                ssPositions[i] = Math.random() * 3000 - 1500;
                                ssPositions[i+1] = Math.random() * 1000 + 1000;
                            }
                            ssPositions[i+2] = Math.random() * 4000 - 2000;
                        }
                    }
                    shootingStars.geometry.attributes.position.needsUpdate = true;
                    
                    renderer.render(scene, camera);
                }

                init();
                animate();
            }

            // 返回主頁按鈕的邏輯
            document.getElementById('back-to-home-button').addEventListener('click', () => {
                window.parent.postMessage('closeAlbumViewer', '*'); 
            });
        });
    </script>
</body>
</html>

